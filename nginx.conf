worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;

        # üí° –í–∞–∂–Ω–æ: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º WordPress –º–∞—Ä—à—Ä—É—Ç—ã

        # WordPress –∞–¥–º–∏–Ω–∫–∞ –∏ –ª–æ–≥–∏–Ω
         location ~ ^/(wp|wp-admin|wp-login\.php|admin)(/*.*)?$ {
            proxy_pass http://wordpress:80;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # WordPress API
        location ~ ^/w-api/ {
            proxy_pass http://wordpress;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        location / {
            proxy_pass http://nuxt:3000;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # Nuxt (–≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ)
    #    location / {
    #     proxy_pass http://nuxt:3000;
    #     proxy_http_version 1.1;
    #     proxy_set_header Upgrade $http_upgrade;
    #     proxy_set_header Connection 'upgrade';
    #     proxy_set_header Host $host;
    #     proxy_cache_bypass $http_upgrade;
    # }
    }
}
